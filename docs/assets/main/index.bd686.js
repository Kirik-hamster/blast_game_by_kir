window.__require=function e(t,o,r){function i(a,s){if(!o[a]){if(!t[a]){var c=a.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(n)return n(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var u=o[a]={exports:{}};t[a][0].call(u.exports,function(e){return i(t[a][1][e]||e)},u,u.exports,e,t,o,r)}return o[a].exports}for(var n="function"==typeof __require&&__require,a=0;a<r.length;a++)i(r[a]);return i}({AudioManager:[function(e,t,o){"use strict";cc._RF.push(t,"9567827iqBIroYY0sVCnazX","AudioManager");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.SoundType=void 0;var a=cc._decorator,s=a.ccclass,c=a.property;(function(e){e.SMALL="soundSmall",e.BIG="soundBig",e.ROCKET="rocket",e.BOMB_SMALL="bombSmall",e.BOMB_BIG="bombBig",e.WIN="soundWin",e.LOSE="soundLose",e.SHUFFLE="soundShuffle"})(o.SoundType||(o.SoundType={}));var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.soundSmall=null,t.soundBig=null,t.rocket=null,t.bombSmall=null,t.bombBig=null,t.soundWin=null,t.soundLose=null,t.soundShuffle=null,t}var o;return i(t,e),o=t,t.prototype.onLoad=function(){this.node.parent!==cc.director.getScene()&&(this.node.parent=cc.director.getScene()),null===o.instance?(o.instance=this,cc.game.addPersistRootNode(this.node)):this.node.destroy()},t.prototype.playSFX=function(e){var t=this[e];t?cc.audioEngine.playEffect(t,!1):cc.warn("\u0417\u0432\u0443\u043a "+e+" \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 AudioManager!")},t.instance=null,n([c(cc.AudioClip)],t.prototype,"soundSmall",void 0),n([c(cc.AudioClip)],t.prototype,"soundBig",void 0),n([c(cc.AudioClip)],t.prototype,"rocket",void 0),n([c(cc.AudioClip)],t.prototype,"bombSmall",void 0),n([c(cc.AudioClip)],t.prototype,"bombBig",void 0),n([c(cc.AudioClip)],t.prototype,"soundWin",void 0),n([c(cc.AudioClip)],t.prototype,"soundLose",void 0),n([c(cc.AudioClip)],t.prototype,"soundShuffle",void 0),o=n([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],BonusService:[function(e,t,o){"use strict";cc._RF.push(t,"9dc9394oB5Ah6mtHX5wBaWm","BonusService");var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(i,n){function a(e){try{c(r.next(e))}catch(t){n(t)}}function s(e){try{c(r.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,r,i,n,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(e){return function(t){return c([e,t])}}function c(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,r=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(s){n=[6,s],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Data/GameConfig"),a=function(){function e(e,t){this.controller=null,this.model=null,this.controller=e,this.model=t}return e.prototype.startWinBonus=function(e){return r(this,void 0,void 0,function(){var t,o,r,a,s;return i(this,function(i){switch(i.label){case 0:this.controller.fieldBg.pauseSystemEvents(!0),i.label=1;case 1:return this.controller.level.currentMoves>0?(t=Math.floor(Math.random()*this.model.rows),o=Math.floor(Math.random()*this.model.cols),r=this.model.gridData[t][o],this.controller.field.nodesGrid[t][o]&&-1!==this.controller.blockIndices.indexOf(r)?(this.controller.level.currentMoves--,this.controller.updateUI(),a=n.GAME_CONFIG.FEVER_MODE.POSSIBLE_BOOSTERS,s=a[Math.floor(Math.random()*a.length)],this.controller.field.nodesGrid[t][o].destroy(),this.controller.spawnBooster(t,o,s),[4,new Promise(function(e){return setTimeout(e,n.GAME_CONFIG.FEVER_MODE.SPAWN_DELAY_MS)})]):[3,3]):[3,4];case 2:i.sent(),i.label=3;case 3:return[3,1];case 4:return this.activateAllBoostersSequentially(e),[2]}})})},e.prototype.activateAllBoostersSequentially=function(e){for(var t=this,o=null,r=0;r<this.model.rows;r++){for(var i=0;i<this.model.cols;i++){var a=this.model.gridData[r][i];if(-1!==[5,6,9,11,13].indexOf(a)){o={r:r,c:i,id:a};break}}if(o)break}o?(this.controller.activatePowerUp(o.r,o.c,o.id),this.controller.scheduleOnce(function(){t.activateAllBoostersSequentially(e)},n.GAME_CONFIG.FEVER_MODE.EXPLOSION_INTERVAL)):this.controller.scheduleOnce(function(){e&&e()},n.GAME_CONFIG.FEVER_MODE.FINAL_UI_DELAY)},e}();o.default=a,cc._RF.pop()},{"../Data/GameConfig":"GameConfig"}],BoosterService:[function(e,t,o){"use strict";cc._RF.push(t,"8ff2byXlCtG8L2q3w62kRc6","BoosterService"),Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(){}return e.getAffectedArea=function(e,t,o,r,i,n){var a=[];switch(e){case this.ROCKET_H:for(var s=0;s<n;s++)a.push({r:t,c:s});break;case this.ROCKET_V:for(s=0;s<i;s++)a.push({r:s,c:o});break;case this.BOMB:this.addFixedArea(a,t,o,1,i,n),this.addRandomPositions(a,t,o,2,2,5,i,n);break;case this.BOMB_MAX:this.addFixedArea(a,t,o,2,i,n),this.addRandomPositions(a,t,o,3,3,10,i,n);break;case this.COLOR_REMOVER:var c=this.getRandomNeighborColor(t,o,r,i,n);-1!==c&&(a=this.getAllTilesOfColor(c,r,i,n)),a.push({r:t,c:o})}return a},e.getStarComboArea=function(e,t,o,r,i){var n=[];switch(e){case this.COLOR_REMOVER:for(var a=0;a<r;a++)for(var s=0;s<i;s++)n.push({r:a,c:s});break;case this.ROCKET_H:for(var c=-1;c<=1;c++){var l=t+c;if(l>=0&&l<r)for(s=0;s<i;s++)n.push({r:l,c:s})}break;case this.ROCKET_V:for(var u=-1;u<=1;u++){var d=o+u;if(d>=0&&d<i)for(a=0;a<r;a++)n.push({r:a,c:d})}break;case this.BOMB:this.addMegaCross(n,t,o,1,r,i);break;case this.BOMB_MAX:this.addMegaCross(n,t,o,2,r,i)}return n},e.addMegaCross=function(e,t,o,r,i,n){for(var a=-r;a<=r;a++){var s=t+a;if(s>=0&&s<i)for(var c=0;c<n;c++)e.push({r:s,c:c})}for(var l=function(t){var r=o+t;if(r>=0&&r<n)for(var a=function(t){e.some(function(e){return e.r===t&&e.c===r})||e.push({r:t,c:r})},s=0;s<i;s++)a(s)},u=-r;u<=r;u++)l(u)},e.addFixedArea=function(e,t,o,r,i,n){for(var a=-r;a<=r;a++)for(var s=-r;s<=r;s++){var c=t+a,l=o+s;c>=0&&c<i&&l>=0&&l<n&&e.push({r:c,c:l})}},e.addRandomPositions=function(e,t,o,r,i,n,a,s){for(var c=[],l=-r;l<=r;l++)for(var u=function(r){var i=t+l,n=o+r;i>=0&&i<a&&n>=0&&n<s&&(e.some(function(e){return e.r===i&&e.c===n})||c.push({r:i,c:n}))},d=-i;d<=i;d++)u(d);for(var h=0;h<n&&c.length>0;h++){var p=Math.floor(Math.random()*c.length),f=c.splice(p,1)[0];e.push(f)}},e.calculateChainExplosion=function(e,t,o,r,i,n){for(var a=this,s=[{r:e,c:t,id:o}],c=[],l=[],u=new Set;s.length>0;){var d=s.shift(),h=d.r+","+d.c;u.has(h)||(u.add(h),l.push(d),this.getAffectedArea(d.id,d.r,d.c,r,i,n).forEach(function(e){c.some(function(t){return t.r===e.r&&t.c===e.c})||c.push(e);var t=r[e.r][e.c];a.isBooster(t)&&!u.has(e.r+","+e.c)&&s.push({r:e.r,c:e.c,id:t})}))}return{totalArea:c,activatedBoosters:l}},e.getAllTilesOfColor=function(e,t,o,r){for(var i=[],n=0;n<o;n++)for(var a=0;a<r;a++)t[n][a]===e&&i.push({r:n,c:a});return i},e.getRandomNeighborColor=function(e,t,o,r,i){var n=this,a=[];return[{dr:-1,dc:0},{dr:1,dc:0},{dr:0,dc:-1},{dr:0,dc:1}].forEach(function(s){var c=e+s.dr,l=t+s.dc;if(c>=0&&c<r&&l>=0&&l<i){var u=o[c][l];-1===u||n.isBooster(u)||a.push(u)}}),0===a.length?-1:a[Math.floor(Math.random()*a.length)]},e.getRandomBoosterId=function(){var e=[5,6,9,11,13];return e[Math.floor(Math.random()*e.length)]},e.isBooster=function(e){return-1!==[this.BOMB,this.BOMB_MAX,this.ROCKET_H,this.ROCKET_V,this.COLOR_REMOVER].indexOf(e)},e.ROCKET_H=11,e.ROCKET_V=9,e.BOMB=5,e.BOMB_MAX=6,e.COLOR_REMOVER=13,e.RANDOM_SPAWNER=14,e}();o.default=r,cc._RF.pop()},{}],FieldManager:[function(e,t,o){"use strict";cc._RF.push(t,"b1435CgqAhKTJrguXvM4gyX","FieldManager");var r=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,n=function(){function e(e){this.nodesGrid=[],this.controller=null,this.rows=10,this.cols=9,this.spacingX=100,this.spacingY=100,this.controller=e}return e.prototype.createNodeAt=function(e,t,o){var r=this,i=cc.instantiate(this.controller.tilePrefab);i.parent=this.controller.fieldBg,i.setContentSize(100,112);var n=(t-(this.cols-1)/2)*this.spacingX,a=(e-(this.rows-1)/2)*this.spacingY;i.setPosition(n,a);var s=i.getComponent(cc.Sprite);return s&&this.controller.tileTextures[o]&&(s.spriteFrame=this.controller.tileTextures[o]),i.colorID=o,i.on(cc.Node.EventType.TOUCH_END,function(){return r.controller.onTileClick(e,t)}),this.nodesGrid[e][t]=i,i},e.prototype.destroyTiles=function(e){var t=this;e.forEach(function(e){var o=t.nodesGrid[e.r][e.c];o&&(o.destroy(),t.nodesGrid[e.r][e.c]=null)})},e.prototype.applyGravity=function(e){for(var t=this,o=function(e){for(var o=0,i=function(i){if(null===r.nodesGrid[i][e])o++;else if(o>0){var n=r.nodesGrid[i][e],a=i-o;r.nodesGrid[a][e]=n,r.nodesGrid[i][e]=null,r.controller.model.gridData[a][e]=r.controller.model.gridData[i][e],r.controller.model.gridData[i][e]=-1;var s=(a-(r.rows-1)/2)*r.spacingY;cc.tween(n).to(.3,{y:s},{easing:"bounceOut"}).start(),n.off(cc.Node.EventType.TOUCH_END),n.on(cc.Node.EventType.TOUCH_END,function(){return t.controller.onTileClick(a,e)})}},n=0;n<r.rows;n++)i(n);r.fillEmptyTop(e,o)},r=this,i=0;i<this.cols;i++)o(i);this.controller.scheduleOnce(function(){return e()},.4)},e.prototype.fillEmptyTop=function(e,t){for(var o=0;o<t;o++){var r=this.rows-t+o,i=this.controller.blockIndices[Math.floor(Math.random()*this.controller.blockIndices.length)];this.controller.model.gridData[r][e]=i;var n=this.createNodeAt(r,e,i),a=n.y;n.y=(this.rows+o-(this.rows-1)/2)*this.spacingY,cc.tween(n).to(.3,{y:a},{easing:"bounceOut"}).start()}},e.prototype.shake=function(e,t){if(void 0===t&&(t=10),e){var o=e.getPosition();cc.tween(e).to(.05,{position:cc.v3(o.x+t,o.y+t,0)}).to(.05,{position:cc.v3(o.x-t,o.y-t,0)}).to(.05,{position:cc.v3(o.x+t,o.y-t,0)}).to(.05,{position:cc.v3(o.x,o.y,0)}).start()}},e.prototype.animateShuffle=function(e){for(var t=[],o=0;o<this.rows;o++)for(var r=0;r<this.cols;r++)this.nodesGrid[o][r]&&t.push(this.nodesGrid[o][r]);t.forEach(function(t,o){cc.tween(t).to(1.2,{scale:0,angle:360},{easing:"backIn"}).delay(.4).call(function(){0===o&&e&&e()}).to(1,{scale:1,angle:0},{easing:"backOut"}).start()})},r([i],e)}();o.default=n,cc._RF.pop()},{}],GameConfig:[function(e,t,o){"use strict";cc._RF.push(t,"1bf7bSZ2lpHyqWHR8ph25rA","GameConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o.GAME_CONFIG=void 0,o.GAME_CONFIG={START_MOVES:27,TARGET_SCORE:500,AUTO_SHUFFLE_LIMIT:3,INITIAL_TELEPORT_COUNT:3,INITIAL_BOMB_COUNT:3,MIN_MATCH_SIZE:2,HINT_DELAY:5,THRESHOLDS:{ROCKET:{min:5,max:6},BOMB_SMALL:{min:7,max:8},BOMB_MAX:{min:9,max:11},COLOR_REMOVER:{min:12,max:999999}},POINTS_PER_NORMAL_TILE:1,BOOSTER_EXPLOSION_DIVIDER:2,GRAVITY_DELAY:.1,CHECK_STATE_DELAY:.5,FALL_DURATION:.4,FEVER_MODE:{SPAWN_DELAY_MS:500,EXPLOSION_INTERVAL:.66,FINAL_UI_DELAY:1.5,POSSIBLE_BOOSTERS:[5,6,9,11,13]}},cc._RF.pop()},{}],GameController:[function(e,t,o){"use strict";cc._RF.push(t,"153814aTfdE5qj6gu6dMaop","GameController");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a,s=e("./GridModel"),c=e("../Services/BoosterService"),l=e("../Services/HintService"),u=e("../Services/BonusService"),d=e("../Services/AudioManager"),h=e("../UI/UIManager"),p=e("../Data/GameConfig"),f=e("../Data/GlobalData"),v=e("./LevelManager"),m=e("./FieldManager"),g=e("../Data/LevelConfig"),b=cc._decorator,y=b.ccclass,S=b.property;(function(e){e[e.PAUSE=0]="PAUSE",e[e.WIN=1]="WIN",e[e.LOSE=2]="LOSE"})(a||(a={}));var E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.menuButton=null,t.tilePrefab=null,t.fieldBg=null,t.tileTextures=[],t.model=null,t.hintService=null,t.bonusService=null,t.level=null,t.field=null,t.ui=null,t.isTeleportActive=!1,t.firstSelectedTile=null,t.autoShuffleCount=0,t.blockIndices=[4,7,8,10,12],t.rocketIndices=[9,11],t.bombIdx=5,t.maxBombIdx=6,t.colorRemoverIdx=13,t.isColorRemoverActive=!1,t.activeRemoverPos=null,t.isEndingStarted=!1,t}return i(t,e),t.prototype.start=function(){this.level=new v.default,this.field=new m.default(this),this.setupLevel(),this.isEndingStarted=!1,this.model=new s.default(this.field.rows,this.field.cols),this.bonusService=new u.default(this,this.model),this.hintService=new l.default(this,this.model,this.blockIndices),this.ui&&(this.ui.gameplayUI&&(this.ui.gameplayUI.active=!0),this.ui.menuUI&&(this.ui.menuUI.active=!1)),this.updateUI(),this.generateField(),this.setupEventListeners(),this.hintService.resetTimer(),this.showPreGameMenu()},t.prototype.getMinMatchSize=function(){var e=g.LEVEL_DATA[f.default.selectedLevel];return e&&e.minMatch?e.minMatch:p.GAME_CONFIG.MIN_MATCH_SIZE},t.prototype.showPreGameMenu=function(){this.ui&&(this.ui.gameplayUI.active=!1,this.ui.menuUI.active=!0,this.ui.btnResume&&(this.ui.btnResume.active=!0),this.ui.btnRestart&&(this.ui.btnRestart.active=!1),this.ui.setupTargetMenu(this.getActualTargetsList(),this.tileTextures),cc.director.pause())},t.prototype.showMenu=function(e){this.ui&&this.ui.showMenu(e,this.level.currentScore,this.level.targetScore,this.getActualTargetsList(),this.tileTextures)},t.prototype.setupLevel=function(){var e=g.LEVEL_DATA[f.default.selectedLevel]||g.LEVEL_DATA[1];console.log("\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0431\u0443\u0441\u0442\u0435\u0440\u043e\u0432: ",e.activeBoosters),console.log("\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410 \u0414\u0410\u041d\u041d\u042b\u0425 \u0414\u041b\u042f \u0423\u0420\u041e\u0412\u041d\u042f \u2116",f.default.selectedLevel),this.ui&&this.ui.setupBoosterPanel(e.activeBoosters),this.updateUI()},t.prototype.getActualTargetsList=function(){var e=[];return this.level.targetsProgress.forEach(function(t,o){e.push({id:o,count:t})}),e},t.prototype.setupEventListeners=function(){var e=this,t=h.default.instance;t&&(this.menuButton?this.menuButton.on(cc.Node.EventType.TOUCH_END,function(){t.playClickAnimation(e.menuButton,function(){e.showMenu(a.PAUSE)})}):cc.error("\u0417\u0430\u0431\u044b\u043b \u043f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u044c \u043a\u043d\u043e\u043f\u043a\u0443 menuButton \u0432 \u0438\u043d\u0441\u043f\u0435\u043a\u0442\u043e\u0440 GameController!"),this.ui.btnResume&&this.ui.btnResume.on(cc.Node.EventType.TOUCH_END,function(){cc.director.resume(),t.playClickAnimation(e.ui.btnResume,function(){e.level.isWin()?f.default.selectedLevel<10?(f.default.selectedLevel++,e.restartGame()):cc.director.loadScene("MapScene"):e.ui.menuUI&&(e.ui.menuUI.active=!1,e.ui.gameplayUI.active=!0)})}),this.ui.btnRestart&&this.ui.btnRestart.on(cc.Node.EventType.TOUCH_END,function(){cc.director.resume(),t.playClickAnimation(e.ui.btnRestart,function(){e.restartGame()})}),this.ui.btnExit&&this.ui.btnExit.on(cc.Node.EventType.TOUCH_END,function(){cc.director.resume(),t.playClickAnimation(e.ui.btnExit,function(){cc.director.loadScene("MapScene")})}),this.ui.btnTeleport&&this.ui.btnTeleport.on(cc.Node.EventType.TOUCH_END,function(o){e.level.teleports<=0||(e.isTeleportActive?(e.isTeleportActive=!1,t.setBoosterVisualActive(e.ui.btnTeleport,!1),e.firstSelectedTile&&(cc.tween(e.firstSelectedTile.node).to(.1,{scale:1}).start(),e.firstSelectedTile=null),cc.log("\u0422\u0415\u041b\u0415\u041f\u041e\u0420\u0422: \u0420\u0435\u0436\u0438\u043c \u043e\u0442\u043c\u0435\u043d\u0435\u043d \u0438\u0433\u0440\u043e\u043a\u043e\u043c")):(e.isTeleportActive=!0,t.setBoosterVisualActive(e.ui.btnTeleport,!0),cc.log("\u0422\u0415\u041b\u0415\u041f\u041e\u0420\u0422: \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0435\u0440\u0432\u044b\u0439 \u0442\u0430\u0439\u043b")),o.stopPropagation())}),[{btn:this.ui.btnRandomBomb,action:function(){return e.useRandomBombBooster()},getCount:function(){return e.level.bombs}},{btn:this.ui.btnColorRemover,action:function(){return e.useColorRemoverBooster()},getCount:function(){return e.level.removers}},{btn:this.ui.btnRandomSpawner,action:function(){return e.useRandomSpawnerBooster()},getCount:function(){return e.level.spawners}}].forEach(function(e){e.btn&&e.btn.on(cc.Node.EventType.TOUCH_END,function(o){e.getCount()>0?t.playBoosterClickAnimation(e.btn,function(){return e.action()}):cc.log("\u0411\u0443\u0441\u0442\u0435\u0440 \u0437\u0430\u043a\u043e\u043d\u0447\u0438\u043b\u0441\u044f!"),o.stopPropagation()})}))},t.prototype.useRandomSpawnerBooster=function(){if(!(this.level.spawners<=0)){for(var e=[],t=0;t<this.field.rows;t++)for(var o=0;o<this.field.cols;o++){var r=this.model.gridData[t][o];-1!==this.blockIndices.indexOf(r)&&e.push({r:t,c:o})}if(0!==e.length){var i=e[Math.floor(Math.random()*e.length)],n=c.default.getRandomBoosterId();this.field.nodesGrid[i.r][i.c]&&(this.field.nodesGrid[i.r][i.c].destroy(),this.spawnBooster(i.r,i.c,n),this.level.spawners--,this.updateUI(),cc.log("\u041c\u0410\u0413\u0418\u042f: \u0412 \u044f\u0447\u0435\u0439\u043a\u0435 ["+i.r+","+i.c+"] \u043f\u043e\u044f\u0432\u0438\u043b\u0441\u044f \u0431\u0443\u0441\u0442\u0435\u0440 ID "+n))}}},t.prototype.useColorRemoverBooster=function(){if(!(this.level.removers<=0)){var e=Math.floor(Math.random()*this.field.rows),t=Math.floor(Math.random()*this.field.cols);this.field.nodesGrid[e][t]&&(this.field.nodesGrid[e][t].destroy(),this.spawnBooster(e,t,this.colorRemoverIdx),this.level.removers--,this.updateUI(),cc.log("\u0411\u0423\u0421\u0422\u0415\u0420: \u0417\u0432\u0435\u0437\u0434\u0430 \u043f\u043e\u044f\u0432\u0438\u043b\u0430\u0441\u044c \u043d\u0430 \u043f\u043e\u043b\u0435! \u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u043d\u0435\u0451, \u0430 \u0437\u0430\u0442\u0435\u043c \u043d\u0430 \u0441\u043e\u0441\u0435\u0434\u043d\u0438\u0439 \u0446\u0432\u0435\u0442."))}},t.prototype.handleTeleportSwap=function(e,t){var o=this,r=this.field.nodesGrid[e][t],i=this.model.gridData[e][t];if(!this.firstSelectedTile){this.isColorRemoverActive&&this.cancelColorRemoverMode(),this.firstSelectedTile={r:e,c:t,node:r};var n=i===this.colorRemoverIdx?.7:1.2;return cc.tween(r).to(.15,{scale:n}).start(),void cc.log("\u041f\u0435\u0440\u0432\u044b\u0439 \u043a\u0443\u0431\u0438\u043a \u0437\u0430\u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d. \u0416\u0434\u0435\u043c \u0432\u0442\u043e\u0440\u043e\u0439.")}var a=this.firstSelectedTile;if(a.r===e&&a.c===t){var s=i===this.colorRemoverIdx?.6:1;return cc.tween(a.node).to(.1,{scale:s}).start(),this.ui.btnTeleport.color=cc.Color.WHITE,this.firstSelectedTile=null,this.isTeleportActive=!1,void cc.log("\u0422\u0435\u043b\u0435\u043f\u043e\u0440\u0442 \u043e\u0442\u043c\u0435\u043d\u0435\u043d")}var c=this.model.gridData[a.r][a.c];this.model.gridData[a.r][a.c]=this.model.gridData[e][t],this.model.gridData[e][t]=c;var l=a.node.getPosition(),u=r.getPosition(),d=this.model.gridData[a.r][a.c]===this.colorRemoverIdx?.6:1,p=this.model.gridData[e][t]===this.colorRemoverIdx?.6:1;cc.tween(a.node).to(.3,{x:u.x,y:u.y,scale:p}).start(),cc.tween(r).to(.3,{x:l.x,y:l.y,scale:d}).start(),this.field.nodesGrid[a.r][a.c]=r,this.field.nodesGrid[e][t]=a.node,a.node.off(cc.Node.EventType.TOUCH_END),r.off(cc.Node.EventType.TOUCH_END),a.node.on(cc.Node.EventType.TOUCH_END,function(){return o.onTileClick(e,t)}),r.on(cc.Node.EventType.TOUCH_END,function(){return o.onTileClick(a.r,a.c)}),this.level.teleports--,this.isTeleportActive=!1,h.default.instance&&h.default.instance.setBoosterVisualActive(this.ui.btnTeleport,!1),this.firstSelectedTile=null,this.updateUI(),this.scheduleOnce(function(){return o.checkGameState()},.4)},t.prototype.generateField=function(){this.model.initGrid(),this.field.nodesGrid=[],this.fieldBg.removeAllChildren();for(var e=0;e<this.field.rows;e++){this.field.nodesGrid[e]=[];for(var t=0;t<this.field.cols;t++){var o=this.model.getSmartColor(e,t,this.blockIndices);this.model.gridData[e][t]=o,this.spawnTile(e,t)}}},t.prototype.activateColorRemoverMode=function(e,t){this.isColorRemoverActive=!0,this.activeRemoverPos={r:e,c:t};var o=this.field.nodesGrid[e][t];o&&cc.tween(o).to(.15,{scale:.7}).start(),cc.log("COLOR REMOVER: \u0422\u0435\u043f\u0435\u0440\u044c \u043d\u0430\u0436\u043c\u0438 \u043d\u0430 \u0441\u043e\u0441\u0435\u0434\u043d\u0438\u0439 \u0446\u0432\u0435\u0442\u043d\u043e\u0439 \u043a\u0443\u0431\u0438\u043a")},t.prototype.cancelColorRemoverMode=function(){if(this.activeRemoverPos){var e=this.field.nodesGrid[this.activeRemoverPos.r][this.activeRemoverPos.c];e&&cc.tween(e).to(.1,{scale:.6}).start()}this.isColorRemoverActive=!1,this.activeRemoverPos=null,cc.log("COLOR REMOVER: \u041e\u0442\u043c\u0435\u043d\u0435\u043d\u043e")},t.prototype.executeColorRemoval=function(e,t){var o=this,r=this.activeRemoverPos,i=this.model.gridData[e][t];if(1===Math.abs(r.r-e)+Math.abs(r.c-t)){var n=[];if(c.default.isBooster(i))cc.log("\u0410\u041a\u0422\u0418\u0412\u0410\u0426\u0418\u042f \u041a\u041e\u041c\u0411\u041e \u0427\u0415\u0420\u0415\u0417 \u0421\u0415\u0420\u0412\u0418\u0421"),n=c.default.getStarComboArea(i,e,t,this.field.rows,this.field.cols),i===this.colorRemoverIdx?(this.field.shake(this.ui.gameplayUI,70),d.default.instance.playSFX(d.SoundType.BOMB_BIG)):(this.field.shake(this.ui.gameplayUI,40),d.default.instance.playSFX(d.SoundType.BOMB_BIG));else{if(-1===this.blockIndices.indexOf(i))return void cc.log("\u0420\u0435\u0436\u0438\u043c \u0417\u0432\u0435\u0437\u0434\u044b: \u0412\u044b\u0431\u0435\u0440\u0438 \u0446\u0432\u0435\u0442\u043d\u043e\u0439 \u043a\u0443\u0431\u0438\u043a \u0438\u043b\u0438 \u0434\u0440\u0443\u0433\u043e\u0439 \u0431\u0443\u0441\u0442\u0435\u0440 \u0440\u044f\u0434\u043e\u043c!");var a=(n=c.default.getAllTilesOfColor(i,this.model.gridData,this.field.rows,this.field.cols)).length>=5?d.SoundType.BIG:d.SoundType.SMALL;d.default.instance.playSFX(a)}n.push(r),this.field.destroyTiles(n),n.forEach(function(e){var t=o.model.gridData[e.r][e.c];o.level.collectItem(t),o.model.gridData[e.r][e.c]=-1}),this.isColorRemoverActive=!1,this.activeRemoverPos=null,this.level.addScore(n.length*p.GAME_CONFIG.POINTS_PER_NORMAL_TILE),this.updateUI(),this.scheduleOnce(function(){o.field.applyGravity(function(){return o.checkGameState()})},p.GAME_CONFIG.GRAVITY_DELAY)}else cc.log("\u041a\u043e\u043c\u0431\u043e \u0438\u043b\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0446\u0432\u0435\u0442\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0441 \u0421\u041e\u0421\u0415\u0414\u041d\u0418\u041c \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u043c!")},t.prototype.onTileClick=function(e,t){var o=this;if(!this.isEndingStarted)if(this.hintService&&this.hintService.resetTimer(),this.isTeleportActive)this.handleTeleportSwap(e,t);else{var r=this.model.gridData[e][t];if(r!==this.colorRemoverIdx)if(this.isColorRemoverActive)this.executeColorRemoval(e,t);else{var i=this.model.findMatches(e,t,r);if(-1===this.rocketIndices.indexOf(r)&&r!==this.bombIdx&&r!==this.maxBombIdx){var n=this.getMinMatchSize();i.forEach(function(e){var t=o.field.nodesGrid[e.r][e.c];t&&cc.tween(t).to(.05,{scale:1.1}).to(.05,{scale:1}).start()}),i.length<n||this.scheduleOnce(function(){d.default.instance.playSFX(i.length>5?d.SoundType.BIG:d.SoundType.SMALL),o.level.useMove(),o.level.addScore(i.length*p.GAME_CONFIG.POINTS_PER_NORMAL_TILE),o.updateUI(),o.field.destroyTiles(i),i.forEach(function(e){var t=o.model.gridData[e.r][e.c];o.level.collectItem(t),o.model.gridData[e.r][e.c]=-1});var r=-1;i.length>=p.GAME_CONFIG.THRESHOLDS.COLOR_REMOVER.min?r=o.colorRemoverIdx:i.length>=p.GAME_CONFIG.THRESHOLDS.BOMB_MAX.min?r=o.maxBombIdx:i.length>=p.GAME_CONFIG.THRESHOLDS.BOMB_SMALL.min?r=o.bombIdx:i.length>=p.GAME_CONFIG.THRESHOLDS.ROCKET.min&&(r=o.rocketIndices[Math.floor(2*Math.random())]),-1!==r&&o.spawnBooster(e,t,r),o.updateUI(),o.scheduleOnce(function(){o.field.applyGravity(function(){o.checkGameState()})},p.GAME_CONFIG.GRAVITY_DELAY)},.1)}else this.activatePowerUp(e,t,r)}else if(this.isColorRemoverActive&&this.activeRemoverPos){if(this.activeRemoverPos.r===e&&this.activeRemoverPos.c===t)return void this.cancelColorRemoverMode();1===Math.abs(this.activeRemoverPos.r-e)+Math.abs(this.activeRemoverPos.c-t)?this.executeColorRemoval(e,t):(this.cancelColorRemoverMode(),this.activateColorRemoverMode(e,t))}else this.activateColorRemoverMode(e,t)}},t.prototype.checkGameState=function(){var e=this;if(!this.isEndingStarted){if(this.level.isWin())return console.log("\u041f\u043e\u0431\u0435\u0434\u0430! \u0417\u0430\u043f\u0443\u0441\u043a \u0431\u043e\u043d\u0443\u0441\u0430..."),this.isEndingStarted=!0,void this.bonusService.startWinBonus(function(){var t=e.level.currentScore,o=e.level.targetScore,r=f.default.calculateStars(t,o);f.default.saveLevelProgress(f.default.selectedLevel,r),console.log("\u0424\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0441\u0447\u0435\u0442: "+t+" \u043e\u0447\u043a\u043e\u0432, \u0437\u0432\u0435\u0437\u0434: "+r+"."),e.showEndGame(!0)});var t=this.getMinMatchSize();if(!this.model.hasPossibleMatches(this.blockIndices,t))return this.autoShuffleCount<p.GAME_CONFIG.AUTO_SHUFFLE_LIMIT?(this.autoShuffleCount++,this.executeShuffleLogic(),void this.scheduleOnce(function(){return e.checkGameState()},3)):void this.showMenu(a.LOSE);this.level.isGameOver()&&(this.isEndingStarted=!0,this.fieldBg.resumeSystemEvents(!0),this.showMenu(a.LOSE))}},t.prototype.executeShuffleLogic=function(){var e=this;d.default.instance.playSFX(d.SoundType.SHUFFLE),this.field.animateShuffle(function(){e.model.shuffleGrid();for(var t=0;t<e.field.rows;t++)for(var o=0;o<e.field.cols;o++){var r=e.field.nodesGrid[t][o];if(r){var i=e.model.gridData[t][o];r.getComponent(cc.Sprite).spriteFrame=e.tileTextures[i],i===e.colorRemoverIdx?r.scale=.6:r.scale=1}}})},t.prototype.showEndGame=function(e){this.ui.menuUI&&this.ui.menuUI.active||(d.default.instance&&d.default.instance.playSFX(e?d.SoundType.WIN:d.SoundType.LOSE),this.showMenu(e?a.WIN:a.LOSE))},t.prototype.restartGame=function(){cc.director.loadScene(cc.director.getScene().name)},t.prototype.updateUI=function(){h.default.instance&&(h.default.instance.updateGameplayUI(this.level.currentScore,this.level.targetScore,this.level.currentMoves,this.level.teleports,this.level.bombs,this.level.removers,this.level.spawners),h.default.instance.updateGameplayTargets(this.getActualTargetsList(),this.tileTextures))},t.prototype.useRandomBombBooster=function(){if(!(this.level.bombs<=0)){this.isTeleportActive&&(this.isTeleportActive=!1,this.ui.btnTeleport&&(this.ui.btnTeleport.color=cc.Color.WHITE),this.firstSelectedTile&&(cc.tween(this.firstSelectedTile.node).to(.1,{scale:1}).start(),this.firstSelectedTile=null));var e=Math.floor(Math.random()*this.field.rows),t=Math.floor(Math.random()*this.field.cols);this.field.nodesGrid[e][t]&&(this.field.nodesGrid[e][t].destroy(),this.spawnBooster(e,t,this.bombIdx),this.level.bombs--,this.updateUI())}},t.prototype.spawnTile=function(e,t){var o=this.model.getSmartColor(e,t,this.blockIndices);this.model.gridData[e][t]=o,this.field.createNodeAt(e,t,o)},t.prototype.spawnBooster=function(e,t,o){this.model.gridData[e][t]=o,this.field.createNodeAt(e,t,o);var r=this.field.nodesGrid[e][t];r&&o===this.colorRemoverIdx&&(r.scale=.6),d.default.instance.playSFX(d.SoundType.SMALL)},t.prototype.activatePowerUp=function(e,t,o){var r=this,i=c.default.calculateChainExplosion(e,t,o,this.model.gridData,this.field.rows,this.field.cols);i.activatedBoosters.forEach(function(e){e.id===r.bombIdx?r.field.shake(r.fieldBg,10):e.id===r.maxBombIdx&&r.field.shake(r.ui.gameplayUI,30);var t=d.SoundType.ROCKET;e.id===r.bombIdx&&(t=d.SoundType.BOMB_SMALL),e.id===r.maxBombIdx&&(t=d.SoundType.BOMB_BIG),d.default.instance.playSFX(t)}),i.totalArea.length>0&&(this.field.destroyTiles(i.totalArea),i.totalArea.forEach(function(e){var t=r.model.gridData[e.r][e.c];r.level.collectItem(t),r.level.addScore(p.GAME_CONFIG.BOOSTER_EXPLOSION_DIVIDER),r.model.gridData[e.r][e.c]=-1})),this.updateUI(),this.field.applyGravity(function(){r.checkGameState()})},n([S(cc.Node)],t.prototype,"menuButton",void 0),n([S(cc.Prefab)],t.prototype,"tilePrefab",void 0),n([S(cc.Node)],t.prototype,"fieldBg",void 0),n([S([cc.SpriteFrame])],t.prototype,"tileTextures",void 0),n([S(h.default)],t.prototype,"ui",void 0),n([y],t)}(cc.Component);o.default=E,cc._RF.pop()},{"../Data/GameConfig":"GameConfig","../Data/GlobalData":"GlobalData","../Data/LevelConfig":"LevelConfig","../Services/AudioManager":"AudioManager","../Services/BonusService":"BonusService","../Services/BoosterService":"BoosterService","../Services/HintService":"HintService","../UI/UIManager":"UIManager","./FieldManager":"FieldManager","./GridModel":"GridModel","./LevelManager":"LevelManager"}],GlobalData:[function(e,t,o){"use strict";cc._RF.push(t,"3cc48OQDhJEzosItUYPs1pQ","GlobalData"),Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(){}return e.calculateStars=function(e,t){if(e<t)return 0;var o=e-t;return o>=150?3:o>=75?2:1},e.openNextLevel=function(e){e>=this.getUnlockedLevel()&&cc.sys.localStorage.setItem(this.UNLOCKED_KEY,(e+1).toString())},e.saveLevelProgress=function(e,t){t>this.getStarsForLevel(e)&&cc.sys.localStorage.setItem(this.STARS_KEY_PREFIX+e,t.toString()),t>=1&&e>=this.getUnlockedLevel()&&cc.sys.localStorage.setItem(this.UNLOCKED_KEY,(e+1).toString())},e.getUnlockedLevel=function(){var e=cc.sys.localStorage.getItem(this.UNLOCKED_KEY);return e?parseInt(e):1},e.getStarsForLevel=function(e){var t=cc.sys.localStorage.getItem(this.STARS_KEY_PREFIX+e);return t?parseInt(t):0},e.selectedLevel=1,e.UNLOCKED_KEY="unlocked_level_index",e.STARS_KEY_PREFIX="stars_lvl_",e}();o.default=r,cc._RF.pop()},{}],GridModel:[function(e,t,o){"use strict";cc._RF.push(t,"6bb474i7f9FUo5fhNmaK/gh","GridModel"),Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(e,t){this.rows=10,this.cols=9,this.gridData=[],this.rows=e,this.cols=t}return e.prototype.initGrid=function(){this.gridData=[];for(var e=0;e<this.rows;e++)this.gridData[e]=[]},e.prototype.isPosValid=function(e,t){return e>=0&&e<this.rows&&t>=0&&t<this.cols},e.prototype.findMatches=function(e,t,o,r){void 0===r&&(r=new Set);var i=e+","+t;if(!this.isPosValid(e,t)||r.has(i)||this.gridData[e][t]!==o)return[];r.add(i);var n=[{r:e,c:t}];return n.push.apply(n,this.findMatches(e+1,t,o,r)),n.push.apply(n,this.findMatches(e-1,t,o,r)),n.push.apply(n,this.findMatches(e,t+1,o,r)),n.push.apply(n,this.findMatches(e,t-1,o,r)),n},e.prototype.hasPossibleMatches=function(e,t){for(var o=new Set,r=0;r<this.rows;r++)for(var i=0;i<this.cols;i++){var n=r+","+i;if(!o.has(n)){var a=this.gridData[r][i];if(-1===e.indexOf(a))return!0;var s=this.findMatches(r,i,a,new Set);if(s.length>=t)return!0;s.forEach(function(e){return o.add(e.r+","+e.c)})}}return!1},e.prototype.getSmartColor=function(e,t,o){var r=[];if(e>0&&void 0!==this.gridData[e-1][t]&&r.push(this.gridData[e-1][t]),t>0&&void 0!==this.gridData[e][t-1]&&r.push(this.gridData[e][t-1]),r.length>0&&Math.random()<.6){var i=r[Math.floor(Math.random()*r.length)];if(-1!==i)return i}return o[Math.floor(Math.random()*o.length)]},e.prototype.shuffleGrid=function(){for(var e,t=[],o=0;o<this.rows;o++)for(var r=0;r<this.cols;r++)-1!==this.gridData[o][r]&&t.push(this.gridData[o][r]);for(var i=t.length-1;i>0;i--){var n=Math.floor(Math.random()*(i+1));e=[t[n],t[i]],t[i]=e[0],t[n]=e[1]}var a=0;for(o=0;o<this.rows;o++)for(r=0;r<this.cols;r++)-1!==this.gridData[o][r]&&(this.gridData[o][r]=t[a++])},e}();o.default=r,cc._RF.pop()},{}],HintService:[function(e,t,o){"use strict";cc._RF.push(t,"83335wC9k1KCqm7dhuKSPN3","HintService"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Data/GameConfig"),i=e("../Data/GlobalData"),n=e("../Data/LevelConfig"),a=function(){function e(e,t,o){this.controller=null,this.model=null,this.blockIndices=[],this.hintNodes=[],this.boundShowHint=null,this.controller=e,this.model=t,this.blockIndices=o,this.boundShowHint=this.showHint.bind(this)}return e.prototype.resetTimer=function(){this.stopHint(),this.controller.unschedule(this.boundShowHint),this.controller.scheduleOnce(this.boundShowHint,r.GAME_CONFIG.HINT_DELAY)},e.prototype.showHint=function(){var e=this,t=this.controller.field.nodesGrid;if(t&&0!==t.length){for(var o=i.default.selectedLevel,a=n.LEVEL_DATA[o],s=a&&a.minMatch?a.minMatch:r.GAME_CONFIG.MIN_MATCH_SIZE,c=[],l=function(e){for(var t=function(t){var o=u.model.gridData[e][t];if(-1===o||-1===u.blockIndices.indexOf(o))return"continue";if(c.some(function(o){return o.some(function(o){return o.r===e&&o.c===t})}))return"continue";var r=u.model.findMatches(e,t,o,new Set);r&&r.length>=s&&c.push(r)},o=0;o<u.model.cols;o++)t(o)},u=this,d=0;d<this.model.rows;d++)l(d);if(c.length>0){var h=c[Math.floor(Math.random()*c.length)];h.forEach(function(o,r){if(t[o.r]&&t[o.r][o.c]){var i=t[o.r][o.c];e.hintNodes.push(i),cc.tween(i).to(.4,{scale:1.1},{easing:"sineInOut"}).to(.4,{scale:1},{easing:"sineInOut"}).union().repeat(5).call(function(){r===h.length-1&&e.resetTimer()}).start()}})}else this.resetTimer()}},e.prototype.stopHint=function(){this.hintNodes.forEach(function(e){e&&e.isValid&&(cc.tween(e).stop(),e.scale=1)}),this.hintNodes=[]},e}();o.default=a,cc._RF.pop()},{"../Data/GameConfig":"GameConfig","../Data/GlobalData":"GlobalData","../Data/LevelConfig":"LevelConfig"}],LevelConfig:[function(e,t,o){"use strict";var r;cc._RF.push(t,"893f2vg78hPCJnNhXRG45zg","LevelConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o.LEVEL_DATA=o.ItemID=void 0,function(e){e[e.RED=4]="RED",e[e.GREEN=7]="GREEN",e[e.BLUE=8]="BLUE",e[e.YELLOW=10]="YELLOW",e[e.PURPLE=12]="PURPLE",e[e.BOMB=5]="BOMB",e[e.BOMB_MAX=6]="BOMB_MAX",e[e.ROCKET_V=9]="ROCKET_V",e[e.ROCKET_H=11]="ROCKET_H",e[e.STAR=13]="STAR",e[e.SPAWNER=14]="SPAWNER"}(r=o.ItemID||(o.ItemID={})),o.LEVEL_DATA={1:{levelLable:"\u0423\u0420\u041e\u0412\u0415\u041d\u042c 1",minMatch:2,moves:20,target:200,targets:[{id:r.RED,count:30},{id:r.GREEN,count:30}],bombs:0,teleports:0,removers:0,spawners:0,activeBoosters:0},2:{levelLable:"\u0423\u0420\u041e\u0412\u0415\u041d\u042c 2",minMatch:2,moves:25,target:400,targets:[{id:r.GREEN,count:45},{id:r.BLUE,count:30},{id:r.BOMB,count:2}],bombs:1,teleports:0,removers:0,spawners:0,activeBoosters:1},3:{levelLable:"\u0423\u0420\u041e\u0412\u0415\u041d\u042c 3",minMatch:2,moves:22,target:400,targets:[{id:r.BOMB_MAX,count:3},{id:r.YELLOW,count:50},{id:r.BLUE,count:50}],bombs:1,teleports:2,removers:0,spawners:0,activeBoosters:2},4:{levelLable:"\u0423\u0420\u041e\u0412\u0415\u041d\u042c 4",minMatch:2,moves:32,target:600,targets:[{id:r.PURPLE,count:30},{id:r.BOMB,count:2},{id:r.GREEN,count:30},{id:r.ROCKET_V,count:3}],bombs:2,teleports:2,removers:1,spawners:0,activeBoosters:3},5:{levelLable:"\u0423\u0420\u041e\u0412\u0415\u041d\u042c 5",minMatch:3,moves:30,target:800,targets:[{id:r.GREEN,count:80},{id:r.RED,count:80},{id:r.ROCKET_V,count:2},{id:r.ROCKET_H,count:2},{id:r.STAR,count:2}],bombs:2,teleports:2,removers:1,spawners:2,activeBoosters:4},6:{levelLable:"\u0423\u0420\u041e\u0412\u0415\u041d\u042c 6",minMatch:3,moves:30,target:850,targets:[{id:r.YELLOW,count:93},{id:r.RED,count:93},{id:r.GREEN,count:93},{id:r.BLUE,count:93},{id:r.PURPLE,count:93},{id:r.STAR,count:5}],bombs:3,teleports:2,removers:2,spawners:2,activeBoosters:4},7:{levelLable:"\u0423\u0420\u041e\u0412\u0415\u041d\u042c 7",minMatch:3,moves:30,target:900,targets:[{id:r.RED,count:120},{id:r.GREEN,count:120},{id:r.BOMB_MAX,count:3},{id:r.ROCKET_H,count:3},{id:r.ROCKET_V,count:3},{id:r.STAR,count:3}],bombs:1,teleports:5,removers:3,spawners:4,activeBoosters:4},8:{levelLable:"\u0423\u0420\u041e\u0412\u0415\u041d\u042c 8",minMatch:4,moves:30,target:950,targets:[{id:r.STAR,count:7},{id:r.GREEN,count:130},{id:r.PURPLE,count:130},{id:r.BLUE,count:130},{id:r.YELLOW,count:130},{id:r.RED,count:130}],bombs:4,teleports:5,removers:3,spawners:2,activeBoosters:4},9:{levelLable:"\u0423\u0420\u041e\u0412\u0415\u041d\u042c 9",minMatch:4,moves:40,target:1200,targets:[{id:r.STAR,count:8},{id:r.BOMB_MAX,count:3},{id:r.ROCKET_H,count:4},{id:r.ROCKET_V,count:4},{id:r.GREEN,count:180},{id:r.PURPLE,count:180}],bombs:2,teleports:8,removers:3,spawners:2,activeBoosters:4},10:{levelLable:"\u0423\u0420\u041e\u0412\u0415\u041d\u042c 10",minMatch:4,moves:45,target:1400,targets:[{id:r.STAR,count:20},{id:r.GREEN,count:210},{id:r.PURPLE,count:210},{id:r.BLUE,count:210},{id:r.YELLOW,count:210},{id:r.RED,count:210}],bombs:3,teleports:11,removers:5,spawners:3,activeBoosters:4}},cc._RF.pop()},{}],LevelManager:[function(e,t,o){"use strict";cc._RF.push(t,"d582b2mijJMSYt7lD+SuARZ","LevelManager"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Data/LevelConfig"),i=e("../Data/GlobalData"),n=function(){function e(){this.currentScore=0,this.targetScore=0,this.currentMoves=0,this.teleports=0,this.bombs=0,this.removers=0,this.spawners=0,this.targetsProgress=new Map,this.init()}return e.prototype.init=function(){var e=this,t=r.LEVEL_DATA[i.default.selectedLevel]||r.LEVEL_DATA[1];this.currentScore=0,this.targetScore=t.target,this.currentMoves=t.moves,this.teleports=t.teleports,this.bombs=t.bombs,this.removers=t.removers,this.spawners=t.spawners,this.targetsProgress.clear(),t.targets&&t.targets.forEach(function(t){e.targetsProgress.set(t.id,t.count)})},e.prototype.collectItem=function(e){if(this.targetsProgress.has(e)){var t=this.targetsProgress.get(e);t>0&&this.targetsProgress.set(e,t-1)}},e.prototype.addScore=function(e){this.currentScore+=e},e.prototype.useMove=function(){return this.currentMoves--,this.currentMoves<=0},e.prototype.isWin=function(){var e=this.currentScore>=this.targetScore,t=!0;return this.targetsProgress.forEach(function(e){e>0&&(t=!1)}),e&&t},e.prototype.isGameOver=function(){return this.currentMoves<=0},e}();o.default=n,cc._RF.pop()},{"../Data/GlobalData":"GlobalData","../Data/LevelConfig":"LevelConfig"}],MapManager:[function(e,t,o){"use strict";cc._RF.push(t,"36ddbJz9N1JuYbjnALe3BGu","MapManager");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../Data/GlobalData"),s=e("../Services/AudioManager"),c=e("./MapRender"),l=cc._decorator,u=l.ccclass,d=l.property,h=[255,390,895],p=[-895,-390,-255,255,390,895],f=[-895,-390,-255,255,390,895],v=[-895,-390,-255],m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelButtons=[],t.starsPrefab=null,t.lockedTexture=null,t.unlockedTexture=null,t.bg1=null,t.bg2=null,t.bg3=null,t.bg4=null,t}return i(t,e),t.prototype.start=function(){this.initMapArrows(),this.setupLevels()},t.prototype.setupLevels=function(){var e=this,t=a.default.getUnlockedLevel();this.levelButtons.forEach(function(o,r){var i=r+1,n=i<=t,s=a.default.getStarsForLevel(i),c=o.getComponent(cc.Sprite),l=o.getComponent(cc.Button);c&&(c.spriteFrame=n?e.unlockedTexture:e.lockedTexture),l&&(l.interactable=n,l.enableAutoGrayEffect=!1);var u=o.getChildByName("lvl"+i+"Lable");u&&(u.active=n),n&&e.spawnStarsUnderButton(o,s)})},t.prototype.spawnStarsUnderButton=function(e,t){var o=cc.instantiate(this.starsPrefab);o.parent=e,o.setPosition(0,-88),o.scale=.5,o.children.forEach(function(e,o){e.opacity=o<t?255:100})},t.prototype.initMapArrows=function(){this.bg1&&this.bg1.drawArrows(h),this.bg2&&this.bg2.drawArrows(p),this.bg3&&this.bg3.drawArrows(f),this.bg4&&this.bg4.drawArrows(v)},t.prototype.onLevelClick=function(e,t){var o=parseInt(t);isNaN(o)?(cc.error("\u041e\u0448\u0438\u0431\u043a\u0430: CustomEventData \u0432 \u0438\u043d\u0441\u043f\u0435\u043a\u0442\u043e\u0440\u0435 \u043f\u0443\u0441\u0442 \u0438\u043b\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043d\u0435 \u0447\u0438\u0441\u043b\u043e!"),a.default.selectedLevel=1):(a.default.selectedLevel=o,console.log("\u0412\u044b\u0431\u0440\u0430\u043d \u0443\u0440\u043e\u0432\u0435\u043d\u044c:",a.default.selectedLevel)),s.default.instance&&s.default.instance.playSFX(s.SoundType.SMALL),cc.director.loadScene("MainScene")},n([d([cc.Node])],t.prototype,"levelButtons",void 0),n([d(cc.Prefab)],t.prototype,"starsPrefab",void 0),n([d(cc.SpriteFrame)],t.prototype,"lockedTexture",void 0),n([d(cc.SpriteFrame)],t.prototype,"unlockedTexture",void 0),n([d(c.default)],t.prototype,"bg1",void 0),n([d(c.default)],t.prototype,"bg2",void 0),n([d(c.default)],t.prototype,"bg3",void 0),n([d(c.default)],t.prototype,"bg4",void 0),n([u],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../Data/GlobalData":"GlobalData","../Services/AudioManager":"AudioManager","./MapRender":"MapRender"}],MapRender:[function(e,t,o){"use strict";cc._RF.push(t,"c527aziYz9KRp8d8wrMXrj0","MapRender");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.arrowPrefab=null,t}return i(t,e),t.prototype.drawArrows=function(e){var t=this;this.node.children.forEach(function(e){"arrow"===e.name&&e.destroy()}),e.forEach(function(e){var o=cc.instantiate(t.arrowPrefab);o.parent=t.node,o.name="arrow",o.setPosition(0,e)})},n([c(cc.Prefab)],t.prototype,"arrowPrefab",void 0),n([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],UIManager:[function(e,t,o){"use strict";cc._RF.push(t,"a02e0y7oBdIoZjMLqP3TeFP","UIManager");var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n<3?i(a):n>3?i(t,o,a):i(t,o))||a);return n>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.MenuState=void 0;var a,s=e("../Services/AudioManager"),c=e("../Data/GlobalData"),l=e("../Data/GameConfig"),u=e("../Data/LevelConfig"),d=cc._decorator,h=d.ccclass,p=d.property;(function(e){e[e.PAUSE=0]="PAUSE",e[e.WIN=1]="WIN",e[e.LOSE=2]="LOSE"})(a=o.MenuState||(o.MenuState={}));var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameplayUI=null,t.scoreLabel=null,t.movesLabel=null,t.btnTeleport=null,t.btnRandomBomb=null,t.btnColorRemover=null,t.btnRandomSpawner=null,t.teleportLabel=null,t.boosterBombLabel=null,t.colorRemoverLabel=null,t.randomSpawnerLabel=null,t.boosterPanel=null,t.boosterSlots=[],t.menuUI=null,t.menuTitle=null,t.menuScoreLabel=null,t.btnResume=null,t.btnRestart=null,t.btnExit=null,t.targetContainer=null,t.targetItemPrefab=null,t.scoreHeaderText=null,t.gameplayTargetContainer=null,t.gameplayTargetItemPrefab=null,t.rulePrefab=null,t.rulesContainer=null,t.tileTextures=[],t.currentLevelActiveCount=0,t.BOOSTER_ACTIVE_COLOR=new cc.Color(255,150,150),t}var o;return i(t,e),o=t,t.prototype.onLoad=function(){o.instance=this},t.prototype.setupLevelRules=function(){if(this.rulesContainer&&this.rulePrefab){var e=c.default.selectedLevel,t=u.LEVEL_DATA[e]||u.LEVEL_DATA[1];this.rulesContainer.removeAllChildren();var o=t.minMatch||2;switch(this.addRuleRow("\u0433\u0440\u0443\u043f\u043f\u0430 \u0441\u0433\u043e\u0440\u0430\u043d\u0438\u044f \u043a\u0443\u0431\u043e\u043a\u043e\u0432 \u043e\u0442 "+o,!0,this.tileTextures[0]),e){case 2:this.addRuleRow("\u041f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u0435: \u0441\u0433\u043e\u0440\u0430\u043d\u0438\u0435 \u043a\u0443\u0431\u0438\u043a\u043e\u0432 \u043e\u0442 "+l.GAME_CONFIG.THRESHOLDS.BOMB_SMALL.min+" \u0448\u0442. \u0434\u043e "+l.GAME_CONFIG.THRESHOLDS.BOMB_SMALL.max+" \u0448\u0442.",!1,this.tileTextures[1]),this.addRuleRow("\u041f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u0435: \u0441\u0433\u043e\u0440\u0430\u043d\u0438\u0435 \u043a\u0443\u0431\u0438\u043a\u043e\u0432 \u043e\u0442 "+l.GAME_CONFIG.THRESHOLDS.ROCKET.min+" \u0448\u0442. \u0434\u043e "+l.GAME_CONFIG.THRESHOLDS.ROCKET.max+" \u0448\u0442.",!1,this.tileTextures[6]);break;case 3:this.addRuleRow("\u0422\u0435\u043b\u0435\u043f\u043e\u0440\u0442: \u0416\u043c\u0438 \u0431\u0443\u0441\u0442\u0435\u0440 \u0438 \u0442\u0430\u043f\u043d\u0438 \u043d\u0430 2 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0432 \u043f\u043e\u043b\u0435 \u0434\u043b\u044f \u043e\u0431\u043c\u0435\u043d\u0430.",!1,this.tileTextures[2]),this.addRuleRow("\u041f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u0435: \u0441\u0433\u043e\u0440\u0430\u043d\u0438\u0435 \u043a\u0443\u0431\u0438\u043a\u043e\u0432 \u043e\u0442 "+l.GAME_CONFIG.THRESHOLDS.BOMB_MAX.min+" \u0448\u0442. \u0434\u043e "+l.GAME_CONFIG.THRESHOLDS.BOMB_MAX.max+" \u0448\u0442.",!1,this.tileTextures[3]);break;case 4:this.addRuleRow("\u041f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u0435: \u0441\u0433\u043e\u0440\u0430\u043d\u0438\u0435 >="+l.GAME_CONFIG.THRESHOLDS.COLOR_REMOVER.min+" \u043a\u0443\u0431\u0438\u043a\u043e\u0432. \u0418\u0441\u043f\u043e\u043b\u0437\u043e\u0432\u0430\u043d\u0438\u0435: \u043d\u0430\u0436\u0430\u0442\u044c \u043d\u0430 \u0437\u0432\u0435\u0437\u0434\u0443 \u0438 \u043d\u0430 \u043a\u043b\u0435\u0442\u043a\u0443 \u0440\u044f\u0434\u043e\u043c.",!1,this.tileTextures[4]);break;case 5:this.addRuleRow("\u041c\u0430\u0433\u0438\u044f: \u0441\u043f\u0430\u0432\u043d \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e\u0433\u043e \u0431\u0443\u0441\u0442\u0435\u0440\u0430 \u043d\u0430 \u043f\u043e\u043b\u0435.",!1,this.tileTextures[5]);break;default:e>5&&this.addRuleRow("\u0417\u0432\u0435\u0437\u0434\u0430: \u043e\u0442 "+l.GAME_CONFIG.THRESHOLDS.COLOR_REMOVER.min+" \u043a\u0443\u0431\u0438\u043a\u043e\u0432",!1,this.tileTextures[4])}var r=this.rulesContainer.children,i=r.length>=3?25:35;r.forEach(function(e){var t=e.getChildByName("Lable Rule");if(t){var o=t.getComponent(cc.Label);o&&(o.fontSize=i,o.lineHeight=i+5)}})}},t.prototype.addRuleRow=function(e,t,o){var r=cc.instantiate(this.rulePrefab);r.parent=this.rulesContainer,t&&(i=r.getChildByName("Lable Rule"))&&(i.color=cc.Color.GREEN);var i,n=r.getChildByName("Lable Rule");n&&(i=n.getComponent(cc.Label))&&(i.string=e);var a=r.getChildByName("Icon Rule");a&&o&&(a.getComponent(cc.Sprite).spriteFrame=o)},t.prototype.setupBoosterPanel=function(e){this.currentLevelActiveCount=e;var t=this.boosterPanel.getComponent(cc.Layout),o=Math.min(e+1,4);t.spacingX=4===o?-50:0;for(var r=0;r<this.boosterSlots.length;r++){var i=this.boosterSlots[r];if(i)if(r<o){if(i.active=!0,4===o){i.width=300;var n=i.getChildByName("Slot booster");n&&(n.width=205)}r<e?this.applySafeVisualState(i,255,!0,cc.Color.WHITE):this.applySafeVisualState(i,120,!1,cc.Color.GRAY)}else i.active=!1}t.updateLayout()},t.prototype.updateGameplayUI=function(e,t,o,r,i,n,a){void 0===n&&(n=0),void 0===a&&(a=0),this.scoreLabel&&(this.scoreLabel.string=e+"/"+t),this.movesLabel&&(this.movesLabel.string=o.toString()),this.teleportLabel&&(this.teleportLabel.string=r.toString()),this.boosterBombLabel&&(this.boosterBombLabel.string=i.toString()),this.setBoosterVisualState(this.btnRandomBomb,this.boosterBombLabel,i,0),this.setBoosterVisualState(this.btnTeleport,this.teleportLabel,r,1),this.setBoosterVisualState(this.btnColorRemover,this.colorRemoverLabel,n,2),this.setBoosterVisualState(this.btnRandomSpawner,this.randomSpawnerLabel,a,3)},t.prototype.setBoosterVisualState=function(e,t,o,r){if(e)if(r>this.currentLevelActiveCount)e.active=!1;else{if(r===this.currentLevelActiveCount)return e.active=!0,t&&(t.string="-"),void this.applySafeVisualState(e,150,!1,cc.Color.GRAY);e.active=!0,t&&(t.string=o.toString()),o<=0?this.applySafeVisualState(e,150,!1,cc.Color.GRAY):this.applySafeVisualState(e,255,!0,cc.Color.WHITE)}},t.prototype.applySafeVisualState=function(e,t,o,r){e.opacity=t,e.color=r;var i=e.getComponent(cc.Button);i?i.interactable=o:o?e.resumeSystemEvents(!0):e.pauseSystemEvents(!0)},t.prototype.playClickAnimation=function(e,t){e&&(s.default.instance.playSFX(s.SoundType.SMALL),cc.tween(e).to(.1,{scale:.9}).to(.1,{scale:1}).call(function(){return t()}).start())},t.prototype.playBoosterClickAnimation=function(e,t){e&&(s.default.instance.playSFX(s.SoundType.SMALL),cc.tween(e).to(.1,{scale:.9,color:this.BOOSTER_ACTIVE_COLOR}).to(.1,{scale:1,color:cc.Color.WHITE}).call(function(){return t&&t()}).start())},t.prototype.setBoosterVisualActive=function(e,t){e&&(cc.tween(e).stop(),t?cc.tween(e).to(.1,{scale:.9,color:this.BOOSTER_ACTIVE_COLOR}).start():cc.tween(e).to(.1,{scale:1,color:cc.Color.WHITE}).start())},t.prototype.renderTargetIcons=function(e,t){var o=this;this.targetContainer&&this.targetItemPrefab&&(this.targetContainer.removeAllChildren(),e.forEach(function(e){var r=cc.instantiate(o.targetItemPrefab);r.parent=o.targetContainer;var i=r.getChildByName("Icon");if(i){var n=i.getComponent(cc.Sprite);n&&(n.spriteFrame=t[e.id])}var a=r.getChildByName("Count");if(a){var s=a.getComponent(cc.Label);s&&(s.string=e.count<=0?"\u2705":"\u0445 "+e.count)}}))},t.prototype.showMenu=function(e,t,o,r,i){if(this.menuUI)switch(this.gameplayUI&&(this.gameplayUI.active=!1),this.menuUI.active=!0,this.renderTargetIcons(r,i),this.setupLevelRules(),this.menuScoreLabel&&(this.menuScoreLabel.node.active=!0,this.menuScoreLabel.string=t+"/"+o),e){case a.PAUSE:this.scoreHeaderText&&(this.scoreHeaderText.string="\u041e\u0427\u041a\u041e\u0412 \u041d\u0410\u0411\u0420\u0410\u041d\u041e:"),this.menuTitle&&(this.menuTitle.string="\u041f\u0410\u0423\u0417\u0410"),this.btnRestart&&(this.btnRestart.active=!0),this.btnResume&&(this.btnResume.active=!0),cc.director.pause();break;case a.WIN:this.menuTitle&&(this.menuTitle.string="\u041f\u041e\u0411\u0415\u0414\u0410!"),this.btnRestart&&(this.btnRestart.active=!0),this.btnResume&&(this.btnResume.active=!0),this.prepareEndDisplay(s.SoundType.WIN);break;case a.LOSE:this.scoreHeaderText&&(this.scoreHeaderText.string="\u041e\u0427\u041a\u041e\u0412 \u041d\u0410\u0411\u0420\u0410\u041d\u041e:"),this.menuTitle&&(this.menuTitle.string="\u041f\u041e\u0420\u0410\u0416\u0415\u041d\u0418\u0415"),this.btnRestart&&(this.btnRestart.active=!0),this.btnResume&&(this.btnResume.active=!1),this.prepareEndDisplay(s.SoundType.LOSE)}},t.prototype.prepareEndDisplay=function(e){e!==s.SoundType.WIN&&this.btnResume&&(this.btnResume.active=!1),s.default.instance.playSFX(e)},t.prototype.setupTargetMenu=function(e,t){var o=this;if(this.targetContainer&&this.targetItemPrefab){var r=c.default.selectedLevel,i=u.LEVEL_DATA[r]||u.LEVEL_DATA[1];this.menuTitle&&(this.menuTitle.string=i.levelLable),this.scoreHeaderText&&(this.scoreHeaderText.string="\u041d\u0415\u041e\u0411\u0425\u041e\u0414\u0418\u041c\u041e \u041e\u0427\u041a\u041e\u0412:"),this.menuScoreLabel&&(this.menuScoreLabel.string=i.target.toString()),this.targetContainer.removeAllChildren(),e.forEach(function(e){var r=cc.instantiate(o.targetItemPrefab);r.parent=o.targetContainer,r.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=t[e.id],r.getChildByName("Count").getComponent(cc.Label).string="\u0445  "+e.count}),this.setupLevelRules()}},t.prototype.updateGameplayTargets=function(e,t){var o=this;if(this.gameplayTargetContainer&&this.gameplayTargetItemPrefab){this.gameplayTargetContainer.removeAllChildren();var r=e;if(0!==r.length){var i=this.gameplayTargetContainer.getComponent(cc.Layout),n=r.length<=3?1.3:1;i&&(i.cellSize=cc.size(65*n,65*n),i.spacingX=20*n,i.updateLayout()),r.forEach(function(e){var r=cc.instantiate(o.gameplayTargetItemPrefab);r.parent=o.gameplayTargetContainer,r.scale=n;var i=r.getChildByName("Icon");i&&t[e.id]&&(i.getComponent(cc.Sprite).spriteFrame=t[e.id]);var a=r.getChildByName("Count");if(a){var s=a.getComponent(cc.Label);s&&(s.string=e.count<=0?"\u2705":e.count.toString())}}),i&&i.updateLayout()}}},t.instance=null,n([p(cc.Node)],t.prototype,"gameplayUI",void 0),n([p(cc.Label)],t.prototype,"scoreLabel",void 0),n([p(cc.Label)],t.prototype,"movesLabel",void 0),n([p(cc.Node)],t.prototype,"btnTeleport",void 0),n([p(cc.Node)],t.prototype,"btnRandomBomb",void 0),n([p(cc.Node)],t.prototype,"btnColorRemover",void 0),n([p(cc.Node)],t.prototype,"btnRandomSpawner",void 0),n([p(cc.Label)],t.prototype,"teleportLabel",void 0),n([p(cc.Label)],t.prototype,"boosterBombLabel",void 0),n([p(cc.Label)],t.prototype,"colorRemoverLabel",void 0),n([p(cc.Label)],t.prototype,"randomSpawnerLabel",void 0),n([p(cc.Node)],t.prototype,"boosterPanel",void 0),n([p([cc.Node])],t.prototype,"boosterSlots",void 0),n([p(cc.Node)],t.prototype,"menuUI",void 0),n([p(cc.Label)],t.prototype,"menuTitle",void 0),n([p(cc.Label)],t.prototype,"menuScoreLabel",void 0),n([p(cc.Node)],t.prototype,"btnResume",void 0),n([p(cc.Node)],t.prototype,"btnRestart",void 0),n([p(cc.Node)],t.prototype,"btnExit",void 0),n([p(cc.Node)],t.prototype,"targetContainer",void 0),n([p(cc.Prefab)],t.prototype,"targetItemPrefab",void 0),n([p(cc.Label)],t.prototype,"scoreHeaderText",void 0),n([p(cc.Node)],t.prototype,"gameplayTargetContainer",void 0),n([p(cc.Prefab)],t.prototype,"gameplayTargetItemPrefab",void 0),n([p(cc.Prefab)],t.prototype,"rulePrefab",void 0),n([p(cc.Node)],t.prototype,"rulesContainer",void 0),n([p([cc.SpriteFrame])],t.prototype,"tileTextures",void 0),o=n([h],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../Data/GameConfig":"GameConfig","../Data/GlobalData":"GlobalData","../Data/LevelConfig":"LevelConfig","../Services/AudioManager":"AudioManager"}]},{},["FieldManager","GameController","GridModel","LevelManager","GameConfig","GlobalData","LevelConfig","MapManager","MapRender","AudioManager","BonusService","BoosterService","HintService","UIManager"]);